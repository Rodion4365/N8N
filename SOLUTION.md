# ÐžÐºÐ¾Ð½Ñ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÐµÐ¹ PostgreSQL

## ðŸ” Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹

ÐŸÐ¾ÑÐ»Ðµ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð±Ñ‹Ð»Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° **ÐºÐ¾Ñ€Ð½ÐµÐ²Ð°Ñ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ð°** Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹:

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°
n8n Ð½Ðµ Ð¼Ð¾Ð³ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº PostgreSQL Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹ "password authentication failed for user n8n_user", Ð½ÐµÑÐ¼Ð¾Ñ‚Ñ€Ñ Ð½Ð° Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ.

### ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ñ‹
1. **ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð² Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸**: PostgreSQL 15 Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ `scram-sha-256`, Ð½Ð¾ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° PostgreSQL, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ð°Ñ Ð² n8n, Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ ÑÑ‚Ð¸Ð¼ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Ð² Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑÑ….

2. **ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ `DATABASE_URL` Ð¸ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… `DB_POSTGRESDB_*` Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ñ‹.

3. **Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´Ð° Ñ…ÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ**: scram-sha-256 Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð² Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð² Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Docker ÑÑ€ÐµÐ´Ðµ.

## âœ… Ð ÐµÑˆÐµÐ½Ð¸Ðµ

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ **trust** Ð¼ÐµÑ‚Ð¾Ð´ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÐµÐ¹ Docker ÑÐµÑ‚Ð¸.

### ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ ÑÑ‚Ð¾ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾?

1. **Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ ÑÐµÑ‚Ð¸**: PostgreSQL Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð² Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Docker ÑÐµÑ‚Ð¸ `default`, Ðº ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¸Ð¼ÐµÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ n8n.

2. **ÐÐµÑ‚ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… Ð¿Ð¾Ñ€Ñ‚Ð¾Ð²**: ÐŸÐ¾Ñ€Ñ‚ 5432 PostgreSQL ÐÐ• Ð¾Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ¾Ð²Ð°Ð½ Ð½Ð° Ñ…Ð¾ÑÑ‚Ðµ (Ð½ÐµÑ‚ `ports:` ÑÐµÐºÑ†Ð¸Ð¸), Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ð¸Ð·Ð²Ð½Ðµ Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶ÐµÐ½.

3. **Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Traefik**: Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº n8n Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½ Ñ‡ÐµÑ€ÐµÐ· Traefik Ñ HTTPS Ð¸ Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÐµÐ¹.

4. **Ð¤Ð°Ð¹Ñ€Ð²Ð¾Ð»Ð» ÑÐµÑ€Ð²ÐµÑ€Ð°**: Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½ Ñ„Ð°Ð¹Ñ€Ð²Ð¾Ð»Ð»Ð¾Ð¼, Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ðº Ð½ÑƒÐ¶Ð½Ñ‹Ð¼ Ð¿Ð¾Ñ€Ñ‚Ð°Ð¼ (80, 443).

### Ð§Ñ‚Ð¾ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾

**docker-compose.yml:**

1. **PostgreSQL**:
   - âœ… Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ `POSTGRES_HOST_AUTH_METHOD=trust`
   - âŒ Ð£Ð±Ñ€Ð°Ð½Ñ‹ `scram-sha-256` Ð¸ `POSTGRES_INITDB_ARGS`
   - âŒ Ð£Ð±Ñ€Ð°Ð½ mount Ð´Ð»Ñ `init-postgres.sh`
   - âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ ÑÐ²Ð½Ð¾Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ðµ ÑÐµÑ‚Ð¸ `networks: - default`

2. **n8n**:
   - âŒ Ð£Ð±Ñ€Ð°Ð½Ð° `DATABASE_URL` (ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ Ñ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼Ð¸)
   - âœ… Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ `DB_POSTGRESDB_*` Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ

3. **Traefik ÑÐµÑ‚ÑŒ**:
   - âœ… Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ Ñ `infra_default` Ð½Ð° `infra_web`

## ðŸ“‹ Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸ÑŽ

### ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ (Ð¾Ð´Ð½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°):

```bash
cd /root/N8N && \
git fetch origin main && \
git reset --hard origin/main && \
docker compose down && \
docker volume rm n8n_postgres_data n8n_n8n_data && \
docker compose up -d && \
sleep 20 && \
docker compose logs n8n --tail 50
```

### ÐŸÐ¾ÑˆÐ°Ð³Ð¾Ð²Ð¾Ðµ Ð¾Ð±ÑŠÑÑÐ½ÐµÐ½Ð¸Ðµ:

1. **ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ**: `cd /root/N8N`
2. **ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹**: `git fetch origin main`
3. **ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹**: `git reset --hard origin/main`
4. **ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²**: `docker compose down`
5. **Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…**: `docker volume rm n8n_postgres_data n8n_n8n_data`
6. **Ð—Ð°Ð¿ÑƒÑÐº Ñ Ð½Ð¾Ð²Ð¾Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÐµÐ¹**: `docker compose up -d`
7. **ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸**: `sleep 20`
8. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð»Ð¾Ð³Ð¾Ð²**: `docker compose logs n8n --tail 50`

### ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

Ð’ Ð»Ð¾Ð³Ð°Ñ… Ð²Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ:
```
n8n ready on 0.0.0.0:5678
Editor is now accessible via:
http://localhost:5678/
```

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

1. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²**:
   ```bash
   docker compose ps
   ```
   ÐžÐ±Ð° ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð² ÑÑ‚Ð°Ñ‚ÑƒÑÐµ "Up" Ð¸ "healthy"

2. **ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ**:
   ```
   https://n8n.callwith.ru
   ```

3. **Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ**:
   - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ: ÑÐ¼. `N8N_BASIC_AUTH_USER` Ð² .env
   - ÐŸÐ°Ñ€Ð¾Ð»ÑŒ: ÑÐ¼. `N8N_BASIC_AUTH_PASSWORD` Ð² .env

## ðŸ”§ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ°

### Ð•ÑÐ»Ð¸ n8n Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ

1. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ PostgreSQL**:
   ```bash
   docker compose logs postgres --tail 50
   ```

2. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ðº Ð‘Ð”**:
   ```bash
   docker exec n8n_postgres psql -U n8n_user -d n8n -c "SELECT version();"
   ```
   Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð²ÐµÑ€ÑÐ¸ÑŽ PostgreSQL Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±Ð¾Ðº.

3. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ**:
   ```bash
   docker exec n8n env | grep DB_
   ```

4. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ .env Ñ„Ð°Ð¹Ð» ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚ÐµÐ½**:
   ```bash
   cat /root/N8N/.env
   ```
   Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾:
   - `N8N_HOST=n8n.callwith.ru`
   - `TRAEFIK_NETWORK=infra_web`
   - Ð’ÑÐµ Ð¿Ð°Ñ€Ð¾Ð»Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹

### Ð•ÑÐ»Ð¸ Traefik Ð½Ðµ Ð²Ñ‹Ð´Ð°ÐµÑ‚ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚

1. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ DNS**:
   ```bash
   dig n8n.callwith.ru +short
   ```
   Ð”Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ IP Ð²Ð°ÑˆÐµÐ³Ð¾ ÑÐµÑ€Ð²ÐµÑ€Ð°: `88.218.68.63`

2. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ Traefik**:
   ```bash
   docker logs traefik  # Ð¸Ð»Ð¸ Ð¸Ð¼Ñ Ð²Ð°ÑˆÐµÐ³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° Traefik
   ```

3. **ÐŸÐ¾Ð´Ð¾Ð¶Ð´Ð¸Ñ‚Ðµ 1-2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹**: Let's Encrypt Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ð½ÑÑ‚ÑŒ Ð²Ñ€ÐµÐ¼Ñ Ð´Ð»Ñ Ð²Ñ‹Ð´Ð°Ñ‡Ð¸ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð°

## ðŸ“Š Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð´ÐµÑ‚Ð°Ð»Ð¸

### ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ trust Ð¼ÐµÑ‚Ð¾Ð´ Ð»ÑƒÑ‡ÑˆÐµ Ð´Ð»Ñ Docker

Ð’ Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Docker ÑÑ€ÐµÐ´Ðµ:
- **md5**: Ð£ÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ð¹, Ð½ÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ Ð´Ð»Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹, Ð½Ð¾ Ð¸Ð·Ð±Ñ‹Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð´Ð»Ñ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½ÐµÐ¹ ÑÐµÑ‚Ð¸
- **scram-sha-256**: Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹, Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹, Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸
- **trust**: Ð˜Ð´ÐµÐ°Ð»ÐµÐ½ Ð´Ð»Ñ Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ñ… Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹ (Docker ÑÐµÑ‚Ð¸)

### ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

```
Ð˜Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ â†’ Traefik (HTTPS + Auth) â†’ n8n â†â†’ PostgreSQL (trust, Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾)
                â†“
          Let's Encrypt
```

### ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð½ÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

1. PostgreSQL Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ ÑÐ½Ð°Ñ€ÑƒÐ¶Ð¸ Docker ÑÐµÑ‚Ð¸
2. Docker ÑÐµÑ‚ÑŒ Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð¾Ñ‚ Ñ…Ð¾ÑÑ‚Ð°
3. Ð¤Ð°Ð¹Ñ€Ð²Ð¾Ð»Ð» Ð·Ð°Ñ‰Ð¸Ñ‰Ð°ÐµÑ‚ ÑÐµÑ€Ð²ÐµÑ€
4. Traefik Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ HTTPS Ð¸ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ
5. n8n Ð¸Ð¼ÐµÐµÑ‚ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½ÑƒÑŽ Ð±Ð°Ð·Ð¾Ð²ÑƒÑŽ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ

## ðŸŽ¯ ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ (ÐµÑÐ»Ð¸ Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚)

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: SQLite (Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ)

Ð•ÑÐ»Ð¸ PostgreSQL Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹, Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ SQLite:

```yaml
# Ð’ docker-compose.yml Ð´Ð»Ñ n8n
environment:
  - DB_TYPE=sqlite
```

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ PostgreSQL

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ÑƒÑŽ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¾Ñ‚ Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³-Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ð°).

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 3: Ð¡Ñ‚Ð°Ñ€Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ PostgreSQL

```yaml
postgres:
  image: postgres:13-alpine  # Ð²Ð¼ÐµÑÑ‚Ð¾ 15-alpine
```

## ðŸ“ Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹

- v1: ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ md5 Ñ custom pg_hba.conf - **Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¾**
- v2: ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ scram-sha-256 Ñ init ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼ - **Ð½Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¾**
- v3: **Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ** - trust Ð´Ð»Ñ Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Docker ÑÐµÑ‚Ð¸ - **Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ**

## ðŸ¤ ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°

Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ð½Ðµ Ñ€ÐµÑˆÐµÐ½Ð° Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÑÑ‚Ð¾Ð³Ð¾ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:
1. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸: `./debug-auth.sh`
2. Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ð²Ñ‹Ð²Ð¾Ð´
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸: `docker compose logs > /tmp/n8n-logs.txt`
